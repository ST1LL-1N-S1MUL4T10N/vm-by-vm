
---

### 1. Capture traffic from the zombie host

```bash
sudo tcpdump -i <interface> host 10.10.2.31 -w idle_scan_capture.pcap
```

- Replace <interface> with your network interface (e.g., eth0 or enp0s3).
- Captures all traffic to/from the zombie host and saves it to a .pcap file for analysis.

---

### 2. Check if a host can be used as a zombie

```bash
sudo nmap --script ipidseq.nse 10.10.2.31
```

- Verifies if 10.10.2.31 has a predictable IP ID sequence, which is required for an idle scan.

---

### 3. Perform an idle scan using the zombie host

```bash
sudo nmap -Pn -sI 10.10.2.31 10.10.41.11
```

- Uses the zombie host to scan the target without sending packets directly from your machine.

---

# Nmap Idle Scan Documentation

## 1. Objective

The purpose of this exercise is to perform an idle scan using Nmap to enumerate open TCP ports on a target host (10.10.41.11) without sending packets directly from the attacker host. A "zombie" host (10.10.2.31) is leveraged to remain stealthy.

---

## 2. Tools and Commands

### Step 1: Verify Zombie Host

```bash
sudo nmap --script ipidseq.nse 10.10.2.31
```

Purpose:  
 Determine if 10.10.2.31 has a predictable IP ID sequence, making it suitable as a zombie.

Interpretation:

- Incremental IP ID: usable as zombie
- Random/Static IP ID: not usable

Sample Output:

```
PORT     STATE SERVICE
80/tcp   open  http
139/tcp  open  netbios-ssn
515/tcp  open  printer
9100/tcp open  jetdirect

Host script results:
|_ipidseq: Incremental!
```

Conclusion:  
 10.10.2.31 has an incremental IP ID and is therefore suitable as a zombie.

---

### Step 2: Run Idle Scan

```bash
sudo nmap -Pn -sI 10.10.2.31 10.10.41.11
```

Explanation:

- -sI 10.10.2.31: Performs an idle scan using the zombie host.
- -Pn: Disables host discovery, treating the target as online.

Sample Output:

```
PORT     STATE SERVICE
21/tcp   open  ftp
23/tcp   open  telnet
80/tcp   open  http
443/tcp  open  https
515/tcp  open  printer
631/tcp  open  ipp
8080/tcp open  http-proxy
9100/tcp open  jetdirect
```

Analysis:

- Open ports detected indirectly through the zombie host.
- Services include FTP, Telnet, HTTP/HTTPS, printing (515, 631, 9100), and HTTP proxy (8080).

---

## 3. Observed Traffic Patterns

1. Outgoing SYNs from zombie (10.10.2.31:80) → target (10.0.0.1:various ports)
   - Flags: \[S\] (SYN)
   - Sequence: 1835111941 (identical for all SYNs)
   - Window: 1024, MSS: 1460
   - Observation: Fixed sequence numbers and window sizes indicate the SYNs are generated by a scanning tool, not normal TCP traffic.
2. Incoming SYN-ACKs from target (10.40.1.99 → 10.10.2.31:80)
   - Flags: \[S.\] (SYN-ACK)
   - Response: Zombie immediately replies \[R\] (RST)
   - Interpretation: The target receives spoofed SYNs via the zombie; the zombie responds with RSTs. The scanner infers open ports by monitoring the zombie’s IP ID.
3. Repetition:
   - SYNs are sent rapidly to multiple ports.
   - Each SYN is followed by a SYN-ACK to the zombie, which replies RST.
   - Pattern indicates a systematic port scan.

---

## 4. Traffic Roles

| Role    | IP         | Behavior                                                     |
|---------|------------|--------------------------------------------------------------|
| Scanner | 10.40.1.99 | Sends SYNs indirectly via zombie, monitors IPID changes.     |
| Zombie  | 10.10.2.31 | Receives SYN-ACKs, replies RSTs; unaware of actual scan.     |
| Target  | 10.0.0.1   | Receives SYNs (spoofed from zombie), responds with SYN-ACKs. |

---

## 5. Characteristics of the Packets

- Identical sequence number and window size → synthetic packets from scanning tool.
- Randomized destination ports → enumerates open ports.
- SYN-ACK → RST response → normal idle scan TCP behavior.
- High packet rate → typical of stealth scanning.

---

## 6. How Idle Scan Works (Simplified)

1. Zombie verification: Confirm predictable IP ID sequence.
2. SYN spoofing: Scanner sends SYN packets using zombie IP.
3. Observation: Target responds to zombie; zombie replies with RST.
4. Inference: Scanner monitors zombie’s IP ID changes to determine open ports.

Advantages:

- Stealthy: Target sees only the zombie.
- Indirect: Attacker’s IP is not exposed.

---

## 7. Interpretation

- Traffic confirms an Nmap idle scan (-sI) using 10.10.2.31 as zombie.
- Zombie host reacts to incoming SYN-ACKs but does not initiate scanning.
- Scanner (10.40.1.99) monitors the zombie to infer open ports on the target (10.0.0.1).
- Repeating SYNs with identical sequence numbers and window sizes indicate synthetic scanning packets, not normal traffic.

---

## 8. Summary

- Zombie host: 10.10.2.31 (Incremental IP ID, open HTTP/printer ports)
- Target host: 10.10.41.11 (Open ports discovered via idle scan)
- Open services: FTP, Telnet, HTTP/HTTPS, Printing, IPP, HTTP Proxy
- Technique: Nmap idle scan (-sI), stealthy and indirect.

---
